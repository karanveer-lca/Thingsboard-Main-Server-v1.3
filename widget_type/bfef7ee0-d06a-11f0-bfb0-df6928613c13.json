{
  "entityType" : "WIDGET_TYPE",
  "entity" : {
    "fqn" : "avantec_widgets.simple_state_param_card",
    "name" : "Simple state params card",
    "deprecated" : false,
    "image" : null,
    "description" : null,
    "descriptor" : {
      "type" : "rpc",
      "sizeX" : 7,
      "sizeY" : 2,
      "resources" : [ ],
      "templateHtml" : "<div class=\"tb-rpc-button\" fxLayout=\"column\">\r\n    <div fxFlex=\"{{showTitle ? 20 : 0}}\"\r\n        [ngStyle]=\"{paddingTop: showTitle ? '5px': '0px'}\"\r\n        class=\"title-container\" fxLayout=\"row\"\r\n        fxLayoutAlign=\"start center\" [fxShow]=\"showTitle\">\r\n        <span class=\"button-title\">{{title}}</span>\r\n    </div>\r\n    <div fxFlex=\"{{showTitle ? 80 : 100}}\"\r\n        [ngStyle]=\"{paddingTop: showTitle ? '0px': '0px'}\"\r\n        class=\"button-container\" fxLayout=\"column\"\r\n        fxLayoutAlign=\"center center\">\r\n\r\n        <div class='card'>\r\n            <div class='content'>\r\n                {{displayText}}\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n    <div class=\"error-container\"\r\n        [ngStyle]=\"{'background': error?.length ? 'rgba(255,255,255,0.25)' : 'none'}\"\r\n        fxLayout=\"row\" fxLayoutAlign=\"center center\">\r\n        <span class=\"button-error\">{{ error }}</span>\r\n    </div>\r\n</div>",
      "templateCss" : ".tb-rpc-button {\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n\r\n.tb-rpc-button .title-container {\r\n    font-size: 0.8em;\r\n    font-weight: normal;\r\n    white-space: nowrap;\r\n    opacity: 0.5;\r\n    margin: 0;\r\n}\r\n\r\n.tb-rpc-button .button-container{\r\n    min-width: 80%\r\n}\r\n\r\n.card {\r\n    font-weight: bold;\r\n    font-size: 32px;\r\n    color: #999;\r\n    width: 100%;\r\n    height: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n\r\n.card .content{\r\n    font-size: 22px;\r\n}\r\n",
      "controllerScript" : "// Based on Segment switch of string value\r\n\r\n// let valueSubscription;\r\n\r\nself.onInit = function() {\r\n    self.ctx.ngZone.run(function() {\r\n       init();\r\n       self.ctx.detectChanges(true);\r\n    });\r\n};\r\n\r\nfunction init() {\r\n    let utils       = self.ctx.$scope.$injector.get(self.ctx.servicesMap.get('utils'));\r\n    //let types       = self.ctx.$scope.$injector.get(self.ctx.servicesMap.get('types'));\r\n    //let toast       = self.ctx.$scope.$injector.get(self.ctx.servicesMap.get('toast'));\r\n    let translate   = self.ctx.$scope.$injector.get(self.ctx.servicesMap.get('translate'));\r\n    //let $q          = self.ctx.$scope.$injector.get(self.ctx.servicesMap.get('$q'));\r\n    let http        = self.ctx.$scope.$injector.get(self.ctx.servicesMap.get('http'));\r\n    let attributeService = self.ctx.$scope.$injector.get(self.ctx.servicesMap.get('attributeService'));\r\n    let rpcUpdateStatus = {};\r\n    let settings = utils.deepClone(self.ctx.settings) || {}; \r\n    \r\n    self.ctx.$scope.toastTargetId = 'input-widget' + utils.guid();\r\n    self.ctx.$scope.showTitle = settings.title && settings.title.length ? true : false; ////utils.defaultValue(settings.title, true);\r\n    self.ctx.$scope.title = settings.title;\r\n    //self.ctx.$scope.options = settings.options;\r\n    //self.ctx.$scope.options = [];\r\n    /*for (const item of timezones) {\r\n        self.ctx.$scope.options.push({\r\n            \"optionLabel\": item.name,\r\n            \"attributeValue\": item.offset\r\n        });\r\n    }*/\r\n\r\n    //[ngStyle]=\"{'color': currentValue!==originalValue ? 'rgba(255,0,0,0.87)' : 'none'}\" \r\n    /*function refreshTextColor() {\r\n        if (self.ctx.$scope.currentValue!==self.ctx.$scope.originalValue) {\r\n            self.ctx.$scope.customStyle = {'color': 'rgba(255,0,0,0.87)'};\r\n        } else {\r\n            self.ctx.$scope.customStyle = {'color': 'none'};\r\n        }\r\n        console.log(\"refreshTextColor():\", self.ctx.$scope.currentValue, self.ctx.$scope.originalValue, self.ctx.$scope.customStyle);\r\n    };*/\r\n    \r\n    //console.log(\"onInit\", settings);\r\n    //self.ctx.$scope.currentValue = self.ctx.$scope.originalValue = \"0\";\r\n    //refreshTextColor();\r\n\r\n    let stateParams = {};\r\n    if (!self.ctx.isEdit && self.ctx.stateController) {\r\n        stateParams = self.ctx.stateController.getStateParams();\r\n    }\r\n    let stateParamsConvertFunc = (stateParams) => \"State param\";\r\n    if (settings.stateParamsConvertFunc && settings.stateParamsConvertFunc.length) {\r\n        try {\r\n            stateParamsConvertFunc = new Function('stateParams', settings.stateParamsConvertFunc);\r\n        } catch (e) {\r\n            stateParamsConvertFunc = (stateParams) => \"State param\";\r\n        }\r\n    }\r\n\r\n    //console.log(\"stateParamsConvertFunc\", stateParamsConvertFunc);\r\n    //console.log(\"stateParams\", stateParams);\r\n    //console.log(\"settings\", settings);\r\n\r\n    self.ctx.$scope.displayText = stateParamsConvertFunc(stateParams);\r\n}\r\n\r\nself.onResize = function() {\r\n};\r\n\r\nself.onDestory = function() {\r\n    //if (valueSubscription) {\r\n    //    self.ctx.subscriptionApi.removeSubscription(valueSubscription.id);\r\n    //}\r\n};\r\n\r\n/*self.onDataUpdated = function() {\r\n    try{\r\n        self.ctx.$scope.currentValue = self.ctx.$scope.originalValue = self.ctx.data[0].data[0][1];\r\n        self.ctx.$scope.$digest();\r\n    } catch (e) {\r\n        console.log(e);\r\n    }\r\n}*/\r\n\r\n/*self.typeParameters = function() {\r\n    return {\r\n        maxDatasources: 1, // Maximum allowed datasources for this widget, -1 - unlimited\r\n        maxDataKeys: 1 //Maximum allowed data keys for this widget, -1 - unlimited\r\n    }\r\n};*/\r\n",
      "settingsSchema" : "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"properties\": {\n            \"title\": {\n                \"title\": \"Widget title\",\n                \"type\": \"string\",\n                \"default\": \"\"\n            },\n\n            \"stateParamsConvertFunc\": {\n                \"title\": \"Convert function, f(stateParams), returns display text\",\n                \"type\": \"string\",\n                \"default\": \"return 'State param'; /* console.log(value); */\"\n            }\n        },\n\n        \"required\": [\n            \"stateParamsConvertFunc\"\n        ]\n    },\n    \"form\": [\n        \"title\",\n\n        {\n            \"key\": \"stateParamsConvertFunc\",\n            \"type\": \"javascript\"\n        }\n    ]\n}",
      "dataKeySettingsSchema" : "{}\n",
      "defaultConfig" : "{\"targetDeviceAliases\":[],\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"0px\",\"settings\":{\"requestTimeout\":500,\"patternCommonParam\":\"0\",\"retrieveAttributes\":{\"retrievedAttributeKeyConvertFunc\":\"return patternParamOfRetrievedAttributeKey + patternCommonParam; /* console.log(value); */\",\"patternParamOfRetrievedAttributeKey\":\"value\",\"min\":\"min\",\"max\":\"max\",\"step\":\"step\",\"unit\":\"unit\"},\"updateMethod\":\"rpc\",\"convertValueFunction\":\"return value; /* console.log(value); */\",\"updateRPCMethodConvertNameFunc\":\"return patternParamOfUpdateRPCMethodName + patternCommonParam; /* console.log(value); */\"},\"title\":\"Simple state params card\"}"
    },
    "externalId" : null,
    "resources" : null,
    "id" : {
      "entityType" : "WIDGET_TYPE",
      "id" : "bfef7ee0-d06a-11f0-bfb0-df6928613c13"
    },
    "scada" : false,
    "tags" : null
  },
  "relations" : [ ],
  "attributes" : {
    "SERVER_SCOPE" : [ ]
  }
}