{
  "entityType" : "WIDGET_TYPE",
  "entity" : {
    "fqn" : "avantec_widgets.testattributescard",
    "name" : "Simple Attributes Card",
    "deprecated" : false,
    "image" : null,
    "description" : null,
    "descriptor" : {
      "type" : "latest",
      "sizeX" : 7,
      "sizeY" : 2.5,
      "resources" : [ ],
      "templateHtml" : "",
      "templateCss" : "#container {\r\n    overflow: auto;\r\n}\r\n\r\n.tbDatasource-container {\r\n    margin: 4px;\r\n    padding: 1px;\r\n}\r\n\r\n.tbDatasource-title {\r\n    font-size: 1.200rem;\r\n    font-weight: 500;\r\n    padding-bottom: 10px;\r\n}\r\n\r\n.tbDatasource-table {\r\n    width: 100%;\r\n    box-shadow: 0 0 10px #ccc;\r\n    border-collapse: collapse;\r\n    white-space: nowrap;\r\n    font-size: 1.000rem;\r\n    color: #757575;\r\n}\r\n\r\n.tbDatasource-table td {\r\n    position: relative;\r\n    border-top: 1px solid rgba(0, 0, 0, 0.12);\r\n    border-bottom: 1px solid rgba(0, 0, 0, 0.12);\r\n    padding: 0px 9px;\r\n    box-sizing: border-box;\r\n}",
      "controllerScript" : "// Based on Cards-->Attributes Card\r\n\r\nself.onInit = function() {\r\n    \r\n    //self.ctx.datasourceTitleCells = [];\r\n    self.ctx.valueCells = [];\r\n    self.ctx.labelCells = [];\r\n    \r\n    for (var i=0; i < self.ctx.datasources.length; i++) {\r\n        var tbDatasource = self.ctx.datasources[i];\r\n\r\n        var datasourceId = 'tbDatasource' + i;\r\n        self.ctx.$container.append(\r\n            \"<div id='\" + datasourceId +\r\n            \"' class='tbDatasource-container'></div>\"\r\n        );\r\n\r\n        var datasourceContainer = $('#' + datasourceId,\r\n            self.ctx.$container);\r\n\r\n        //datasourceContainer.append(\r\n        //    \"<div class='tbDatasource-title'>\" +\r\n        //    tbDatasource.name + \"</div>\"\r\n        //);\r\n        \r\n        //var datasourceTitleCell = $('.tbDatasource-title', datasourceContainer);\r\n        //self.ctx.datasourceTitleCells.push(datasourceTitleCell);\r\n        \r\n        var tableId = 'table' + i;\r\n        datasourceContainer.append(\r\n            \"<table id='\" + tableId +\r\n            \"' class='tbDatasource-table'><col width='30%'><col width='70%'></table>\"\r\n        );\r\n        var table = $('#' + tableId, self.ctx.$container);\r\n\r\n        for (var a = 0; a < tbDatasource.dataKeys.length; a++) {\r\n            var dataKey = tbDatasource.dataKeys[a];\r\n            var labelCellId = 'labelCell' + a;\r\n            var cellId = 'cell' + a;\r\n            table.append(\"<tr><td id='\" + labelCellId + \"'>\" + dataKey.label +\r\n                \"</td><td id='\" + cellId +\r\n                \"'></td></tr>\");\r\n            var labelCell = $('#' + labelCellId, table);\r\n            self.ctx.labelCells.push(labelCell);\r\n            var valueCell = $('#' + cellId, table);\r\n            self.ctx.valueCells.push(valueCell);\r\n        }\r\n    }    \r\n    \r\n    self.onResize();\r\n}\r\n\r\nself.onDataUpdated = function() {\r\n    for (var i = 0; i < self.ctx.valueCells.length; i++) {\r\n        var cellData = self.ctx.data[i];\r\n        if (cellData && cellData.data && cellData.data.length > 0) {\r\n            var tvPair = cellData.data[cellData.data.length -\r\n                1];\r\n            var value = tvPair[1];\r\n            var textValue;\r\n            //toDo -> + IsNumber\r\n            \r\n            if (isNumber(value)) {\r\n                var decimals = self.ctx.decimals;\r\n                var units = self.ctx.units;\r\n                if (cellData.dataKey.decimals || cellData.dataKey.decimals === 0) {\r\n                    decimals = cellData.dataKey.decimals;\r\n                }\r\n                if (cellData.dataKey.units) {\r\n                    units = cellData.dataKey.units;\r\n                }\r\n                txtValue = self.ctx.utils.formatValue(value, decimals, units, true);\r\n            } else {\r\n                txtValue = value;\r\n            }\r\n            self.ctx.valueCells[i].html(txtValue);\r\n        }\r\n    }\r\n    \r\n    function isNumber(n) {\r\n        return !isNaN(parseFloat(n)) && isFinite(n);\r\n    }\r\n}\r\n\r\nself.onResize = function() {\r\n    var datasourceTitleFontSize = self.ctx.height/8;\r\n    if (self.ctx.width/self.ctx.height <= 1.5) {\r\n        datasourceTitleFontSize = self.ctx.width/12;\r\n    }\r\n    datasourceTitleFontSize = Math.min(datasourceTitleFontSize, 20);\r\n    //for (var i = 0; i < self.ctx.datasourceTitleCells.length; i++) {\r\n    //    self.ctx.datasourceTitleCells[i].css('font-size', datasourceTitleFontSize+'px');\r\n    //}\r\n    var valueFontSize = self.ctx.height/9;\r\n    var labelFontSize = self.ctx.height/9;\r\n    if (self.ctx.width/self.ctx.height <= 1.5) {\r\n        valueFontSize = self.ctx.width/15;\r\n        labelFontSize = self.ctx.width/15;\r\n    }\r\n    valueFontSize = Math.min(valueFontSize, 18);\r\n    labelFontSize = Math.min(labelFontSize, 18);\r\n\r\n    for (i = 0; i < self.ctx.valueCells; i++) {\r\n        self.ctx.valueCells[i].css('font-size', valueFontSize+'px');\r\n        self.ctx.valueCells[i].css('height', valueFontSize*2.5+'px');\r\n        self.ctx.valueCells[i].css('padding', '0px ' + valueFontSize*0.5 + 'px');\r\n        self.ctx.labelCells[i].css('font-size', labelFontSize+'px');\r\n        self.ctx.labelCells[i].css('height', labelFontSize*2.5+'px');\r\n        self.ctx.labelCells[i].css('padding', '0px ' + labelFontSize*0.5 + 'px');\r\n    }    \r\n}\r\n\r\nself.onDestroy = function() {\r\n}\r\n\r\nself.typeParameters = function() {\r\n    return {\r\n        maxDatasources: 1, // Maximum allowed datasources for this widget, -1 - unlimited\r\n        maxDataKeys: -1 //Maximum allowed data keys for this widget, -1 - unlimited\r\n    };\r\n}\r\n",
      "settingsSchema" : "{}",
      "dataKeySettingsSchema" : "{}\n",
      "defaultConfig" : "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#2196f3\",\"settings\":{},\"_hash\":0.15479322438769105,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Cos\",\"color\":\"#4caf50\",\"settings\":{},\"_hash\":0.5242256504485792,\"funcBody\":\"return Math.round(1000*Math.cos(time/5000));\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Sin\",\"color\":\"#f44336\",\"settings\":{},\"_hash\":0.5818890099680771,\"funcBody\":\"return Math.round(1000*Math.sin(time/5000));\"}]}],\"timewindow\":{\"realtime\":{\"timewindowMs\":60000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{},\"title\":\"Simple Attributes Card\",\"showTitleIcon\":false,\"titleIcon\":\"more_horiz\",\"iconColor\":\"rgba(0, 0, 0, 0.87)\",\"iconSize\":\"24px\",\"titleTooltip\":\"\",\"dropShadow\":true,\"enableFullscreen\":true,\"widgetStyle\":{},\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"useDashboardTimewindow\":true,\"displayTimewindow\":true,\"showLegend\":false,\"actions\":{}}"
    },
    "externalId" : null,
    "resources" : null,
    "id" : {
      "entityType" : "WIDGET_TYPE",
      "id" : "bfe545b0-d06a-11f0-bfb0-df6928613c13"
    },
    "scada" : false,
    "tags" : null
  },
  "relations" : [ ],
  "attributes" : {
    "SERVER_SCOPE" : [ ]
  }
}